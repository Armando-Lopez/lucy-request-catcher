<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lucy - Request catcher</title>
    <style>
      button {
        cursor: pointer;
      }
    </style>
  </head>
  <body
    style="width: 700px; height: 600px; overflow: hidden"
    class="text-gray-600"
  >
    <div class="h-full pt-2 text-base flex flex-col">
      <div class="px-4 flex">
        <h1 class="mb-5 text-2xl text-purple-800 font-bold">
          Lucy - Request catcher
        </h1>
        <span class="ml-auto text-5xl rotate-180">ğŸ•·ï¸</span>
      </div>
      <!-- PestanÌƒas -->
      <div class="flex border-b border-purple-300">
        <button
          class="tab-btn px-4 py-2 text-sm font-medium hover:text-purple-700 border-b-2 border-transparent focus:outline-none"
          data-tab="tab1"
        >
          TelaraÃ±a
        </button>
        <button
          class="tab-btn px-4 py-2 text-sm font-medium hover:text-purple-700 border-b-2 border-transparent focus:outline-none"
          data-tab="tab2"
        >
          Nuevo/Editar
        </button>
        <button
          class="tab-btn px-4 py-2 text-sm font-medium hover:text-purple-700 border-b-2 border-transparent focus:outline-none"
          data-tab="tab3"
        >
          Espiar peticiones
        </button>
        <button
          class="tab-btn px-4 py-2 text-sm font-medium hover:text-purple-700 border-b-2 border-transparent focus:outline-none"
          data-tab="tab4"
        >
          Opciones
        </button>
        <button
          class="tab-btn px-4 py-2 text-sm font-medium hover:text-purple-700 border-b-2 border-transparent focus:outline-none"
          data-tab="tab5"
        >
          Acerca
        </button>
      </div>
      <!-- Contenido -->
      <div id="tabs-container" class="flex-1 overflow-y-auto px-5 pt-3 mb-1">
        <!-- Contenido de la pestaÃ±a TelaraÃ±a -->
        <div class="tab-content h-full" id="tab1">
          <div id="traps-list" class="h-full space-y-4"></div>
        </div>
        <!-- Contenido de la pestaÃ±a Nuevo/Editar -->
        <div class="tab-content h-full hidden" id="tab2">
          <form id="trap-form" class="grid gap-4" autocomplete="off">
            <input type="text" name="id" id="id" hidden />
            <input type="checkbox" name="active" id="active" hidden />
            <div class="w-full">
              <label for="name">ğŸ“ Nombre de la regla</label>
              <input
                class="control w-full rounded-md border border-gray-300 px-4 py-2 placeholder-gray-400 shadow-sm focus:border-transparent focus:ring-2 focus:ring-purple-500 focus:outline-none"
                type="text"
                id="name"
                name="name"
                placeholder="Mi intercept de usuario"
                required
              />
            </div>
            <div class="w-full">
              <label for="name">ğŸŒ Sitio web</label>
              <input
                class="control w-full rounded-md border border-gray-300 px-4 py-2 placeholder-gray-400 shadow-sm focus:border-transparent focus:ring-2 focus:ring-purple-500 focus:outline-none"
                type="text"
                id="webSite"
                name="webSite"
                placeholder="https://ejemplo.com"
                required
              />
            </div>
            <div class="w-full">
              <label for="url">ğŸ URL a atrapar</label>
              <input
                class="control w-full rounded-md border border-gray-300 px-4 py-2 placeholder-gray-400 shadow-sm focus:border-transparent focus:ring-2 focus:ring-purple-500 focus:outline-none"
                type="text"
                id="url"
                name="url"
                placeholder="https://api.ejemplo.com/api/user/{id}"
                required
              />
            </div>
            <div class="flex flex-wrap gap-5">
              <div class="grid">
                <label for="method">ğŸ“¬ MÃ©todo HTTP</label>
                <select
                  id="method"
                  name="method"
                  required
                  class="control rounded-md border border-gray-300 bg-white p-2 focus:ring-2 focus:ring-purple-500 focus:outline-none"
                >
                  <option selected value="" disabled>Seleciona</option>
                  <option value="GET">GET</option>
                  <option value="POST">POST</option>
                  <option value="PUT">PUT</option>
                  <option value="DELETE">DELETE</option>
                  <option value="PATCH">PATCH</option>
                </select>
              </div>
              <div class="grid">
                <label for="statusCode">ğŸ¯ CÃ³digo de Respuesta</label>
                <input
                  class="control w-24 rounded-md border border-gray-300 px-4 py-2 placeholder-gray-400 shadow-sm focus:border-transparent focus:ring-2 focus:ring-purple-500 focus:outline-none"
                  type="number"
                  id="statusCode"
                  name="statusCode"
                  placeholder="200"
                  required
                />
              </div>
            </div>
            <div class="w-full">
              <label for="response">ğŸª¡ JSON de Respuesta (opcional)</label>
              <textarea
                id="response"
                name="response"
                rows="5"
                placeholder='{"id": 1, "name": "Lucy"}'
                class="control w-full rounded-md border border-gray-300 px-4 py-2 placeholder-gray-400 shadow-sm focus:border-transparent focus:ring-2 focus:ring-purple-500 focus:outline-none"
              ></textarea>
            </div>
            <div
              class="sticky bottom-0 py-2 px-4 w-full flex justify-end bg-white border-t border-purple-300"
            >
              <button
                type="submit"
                class="block w-fit rounded-md bg-purple-500 p-2 px-4 text-white hover:bg-purple-600"
              >
                Guardar
              </button>
            </div>
          </form>
        </div>
        <!-- Contenido de la pestaÃ±a Espiar -->
        <div class="tab-content h-full hidden" id="tab3">
          <div class="h-full flex flex-col gap-4">
            <div class="flex justify-between items-center px-2">
              <!-- <button
                id="toggle-active-spy"
                class="self-end block w-fit rounded-md bg-purple-500 py-1.5 px-2 text-white hover:bg-purple-600 text-sm"
              >
                Activar Espia
              </button> -->
              <span class="text-sm text-gray-500">Ãšltimas 30 peticiones</span>
              <div class="flex items-center gap-2">
                <button
                  id="clear-spies-list"
                  class="self-end block w-fit rounded-md ring-2 ring-purple-500 py-1 px-2 text-purple-500 hover:bg-purple-200 text-sm"
                >
                  Limpiar lista
                </button>
              </div>
            </div>
            <p id="no-spies" class="w-100 mx-auto mt-20 text-xl text-center">
              AquÃ­ podrÃ¡s ver peticiones HTTP recientes y convertirlas
              fÃ¡cilmente en nuevas trampas ğŸ•µï¸â€â™€ï¸
            </p>
            <div id="requests-spies-list" class="h-full"></div>
            <!-- <div class="h-full space-y-4"></div> -->
          </div>
        </div>
        <!-- Contenido de la pestaÃ±a Opciones -->
        <div class="tab-content h-full hidden" id="tab4">
          <div class="flex gap-2">
            <button
              id="exportBugs"
              class="rounded-md border border-purple-500 p-2 px-4 hover:bg-purple-200 active:bg-purple-300"
            >
              ğŸ“¤ Exportar reglas
            </button>
            <button
              id="importBugs"
              class="rounded-md border border-purple-500 p-2 px-4 hover:bg-purple-200 active:bg-purple-300"
            >
              ğŸ“¥ Importar reglas
            </button>
            <input type="file" id="importBugsFile" accept=".json" hidden />
          </div>
        </div>
        <!-- Contenido de la pestaÃ±a Acerca -->
        <div class="tab-content h-full hidden space-y-4" id="tab5">
          <div id="intro">
            <span class="text-sm text-gray-500">Version 1.0.1</span>
            <h3 class="text-xl font-bold flex items-center">
              Hola, soy Lucy la aranÌƒa
              <span class="text-5xl rotate-180">ğŸ•·ï¸</span>
            </h3>
            <p>
              Soy Lucy, tu amigable araÃ±a del cÃ³digo. Mi trabajo es muy simple
              (y un poco pegajoso): me encargo de atrapar peticiones HTTP
              (bichos) en mi telaraÃ±a digital antes de que lleguen al servidor.
            </p>
            <strong>Mis objetivos son claros:</strong>
            <ul class="list-disc list-inside pl-4">
              <li>
                ğŸ¯ Interceptar peticiones
                <span class="text-purple-700">Fetch, Axios y XHR</span>.
              </li>
              <li>
                ğŸ•¸ï¸ Revisar si alguna coincide con las trampas (las reglas que
                configuras).
              </li>
              <li>
                ğŸ Si encuentro un bicho que encaja... Â¡zas! Lo atrapo y
                devuelvo una respuesta personalizada.
              </li>
              <li>
                ğŸ•¶ï¸ Si no, dejo que siga su camino como si nada hubiera pasado.
              </li>
            </ul>
            <p>
              Y sÃ­, puedes hablarme con configuraciones â€”soy una araÃ±a moderna,
              Â¡entiendo <span class="text-yellow-700">JavaScript</span>!
            </p>
          </div>
          <hr class="border-purple-800" />
          <div id="create-edit">
            <h4 class="text-lg font-bold flex items-center">
              ğŸ§µ Registrar una trampa en la telaraÃ±a
            </h4>
            <p>
              Cuando quieras enseÃ±arme a atrapar un bicho, sÃ³lo tienes que crear
              la regla en mi formulario de
              <strong class="text-purple-700">Nuevo/Editar</strong>. HarÃ© una
              telaraÃ±a para Ã©l.
            </p>
            <strong>Campos:</strong>
            <ul class="list-disc list-inside pl-4">
              <li>
                ğŸ“ Nombre
                <br />
                AsÃ­ recordamos quÃ© bicho queremos atrapar.
              </li>
              <li>
                ğŸŒ Sitio web
                <br />
                La URL del sitio web donde queremos atrapar el bicho. No
                queremos enredarnos en lugar indebidos.
                <br />
                Por defecto lo llenarÃ© con la URL de la pestaÃ±a actual. SÃ³lo me
                tomare el dominio base.
              </li>
              <li>
                ğŸ URL
                <br />
                AquÃ­ me dices quÃ© URL debo vigilar
                <br />
                Ej: https://api.ejemplo.com/api/users
                <br />
                Si quieres capturar una URL con parÃ¡metros, puedes usar
                <strong>{id}</strong> para indicar donde van los valores con
                nÃºmeros dinÃ¡micos.
                <br />
                Ej: https://api.ejemplo.com/api/users/{id}
              </li>
              <li>
                ğŸ“¬ MÃ©todo HTTP <br />
                Â¿QuÃ© tipo de peticiÃ³n debo atrapar?
                <br />Puedes elegir entre:
                <strong class="text-purple-700"
                  >GET, POST, PUT, DELETE, PATCH</strong
                >
              </li>
              <li>
                ğŸ¯ CÃ³digo de Respuesta
                <br />
                Â¿QuÃ© status HTTP debo devolver si lo atrapo?
                <br />
                Puedes poner,
                <strong class="text-purple-700">200, 404, 500</strong>, etc. Si
                pones un cÃ³digo de error (4xx o 5xx), harÃ© lo posible para
                devolverlo como un error.
              </li>
              <li>
                ğŸª¡ JSON de Respuesta (opcional)
                <br />
                Si quieres que devuelva una respuesta personalizada, escrÃ­bela
                aquÃ­. <br />
                Por ejemplo:
                <pre>
{
  "data": {
    "id": 1,
    "name": "Lucy",
    "job": "HTTP eater"
  }
}
                </pre>
              </li>
            </ul>
            <p>
              Cuando termines, tendrÃ¡s tu regla listada en la telaraÃ±a. Al
              crearla estarÃ¡ desactivada por defecto. SÃ³lo buscala en la lista,
              revisa que todo estÃ© bien y activala.
            </p>
          </div>
          <hr class="border-purple-800" />
          <div id="web">
            <h4 class="text-lg font-bold flex items-center">
              ğŸ•¸ï¸ Mi TelaraÃ±a: donde guardo tus reglas trampa para cazar
            </h4>
            <p>
              AquÃ­ es donde conservo todas las trampas que se han tejido. Puedes
              verlos en la pestaÃ±a
              <strong class="text-purple-700">TelaraÃ±a</strong>. Mira cÃ³mo
              leerla:
            </p>
            <p>ğŸ Cada fila representa una regla para capturar bichos</p>
            <ul class="list-disc list-inside pl-4">
              <li>
                Nombre de la regla
                <br />
              </li>
              <li>Sitio web donde queremos atrapar la peticiÃ³n.</li>
              <li>MÃ©todo y cÃ³digo. Ej: ğŸ¦‹GET-200</li>
              <li>
                URL: Es la URL exacta (o con comodines) que estoy vigilando.
              </li>
              <li>
                Respuesta simulada
                <strong class="text-purple-700"
                  >Haz clic en la url para verla</strong
                >
              </li>
            </ul>
            <p>ğŸ› ï¸ Acciones por regla</p>
            <ul>
              <li>
                ğŸ”µ Editar: Modificamos las reglas de la trampa. <br />
                Cada vez actualices una regla, se desactivarÃ¡. Revisa que todo
                estÃ© bien y activala.
              </li>
              <li>ğŸŸ¥ Borrar: Lo elimino de la telaraÃ±a (sin piedad).</li>
              <li>
                ğŸŸ¢ Liberar: Dejo pasar la peticiÃ³n como si no existiera el
                bicho.
              </li>
              <li>
                âš« Capturar: Lo reactivo para que vuelva a atrapar peticiones.
              </li>
            </ul>
            <br />
            <strong class="text-lg font-bold flex items-center">
              Capturar y Liberar bichos
            </strong>
            <p>Hay dos botones especiales para cada trampa en la telaraÃ±a:</p>
            <p>
              ğŸ•¸ï¸ Capturar
              <br />
              Cuando haces clic en
              <button class="px-2 py-1 text-white rounded-md bg-gray-700">
                Capturar
              </button>
              , activo la trampa. Eso significa:
            </p>
            <ul class="list-disc list-inside pl-4">
              <li>Cualquier peticiÃ³n HTTP que coincida serÃ¡ capturada.</li>
              <li>
                La respuesta falsa (el JSON que configuraste) serÃ¡ devuelta
                automÃ¡ticamente.
              </li>
              <li>
                <strong class="text-purple-700"
                  >âš ï¸ Importante: La peticiÃ³n nunca llegarÃ¡ al servidor real. Me
                  la como antes ğŸ˜‹. Por lo tanto no la verÃ¡s en la informaciÃ³n
                  de red del navegador
                </strong>
              </li>
            </ul>
            <p>
              ğŸ‘‰ VerÃ¡s el botÃ³n cambiar a Liberar para mostrar que estÃ¡ activa.
            </p>
            <p>
              âœ‹ Liberar
              <br />
              Al hacer clic en
              <button class="px-2 py-1 text-white rounded-md bg-green-700">
                Liberar
              </button>
              , Me desenredo un poquito:
            </p>
            <ul class="list-disc list-inside pl-4">
              <li>La trampa se desactiva.</li>
              <li>
                Me tapo mis 8 ojos y hago como que no vi nada. Las peticiones
                siguen su camino directo al servidor, sin interrupciones.
              </li>
            </ul>
            <p>ğŸ‘‰ El botÃ³n cambiarÃ¡ a Capturar de nuevo.</p>
            <p>
              ğŸ§  Consejo:
              <br />
              Puedes activar o desactivar trampas cuando quieras, sin necesidad
              de recargar la pÃ¡gina. Â¡RÃ¡pido y limpio!
              <br />
              Pero si sientes que algo no funciona bien, puedes recargar
              manualmente.
            </p>
            <strong>
              ğŸ§¹ Limpieza automÃ¡tica
            </strong>
            <p>
              En algunos casos requiero,
              <strong class="text-purple-700"
                >sacudir la telaraÃ±a y recargar la pÃ¡gina</strong
              >. Â¿Por quÃ©? Para asegurarme de que no quede ningÃºn hilo colgando,
              que pueda alterar el comportamiento del sitio web.
            </p>
            <p>
              AsÃ­ que si ves que de pronto la pÃ¡gina se recarga... no te
              asustes:
              <strong>Â¡fui yo!</strong> Me asegurÃ© de dejar el entorno tan
              limpio como mi cÃ³digo.
            </p>
          </div>
          <hr class="border-purple-800" />
          <div id="requests-spies">
            <h4 class="text-lg font-bold flex items-center">
              ğŸ•µï¸â€â™€ï¸ Espiar peticiones
            </h4>
            <p>
              Â¿No recuerdas los detalles de la trampa que vas a crear?
              <br />
              Puedo espiar las peticiones recientes y mostrarlas en la pestaÃ±a
              <strong class="text-purple-700">Espiar peticiones</strong>.
            </p>
            <p>
              Haz clic en
              <button class="px-2 py-1 text-white rounded-md bg-green-700">
                Crear trampa
              </button>
              y te llevarÃ© directo al formulario con los datos importantes ya
              listos.
            </p>
            <p>
              Ajusta lo que necesites y guarda la trampa. Â¡Seguimos con la caza!
            </p>
            <p>
              La lista es temporal y sÃ³lo muestra las peticiones mÃ¡s recientes
            </p>
          </div>
          <hr class="border-purple-800" />
          <div id="options">
            <h4 class="text-lg font-bold flex items-center">
              ğŸ§° Opciones: Herramientas de telaraÃ±a
            </h4>
            <p>
              AquÃ­ en mi rincÃ³n de la pestaÃ±a
              <strong class="text-purple-700">Opciones</strong>, te dejo hilos
              mÃ¡gicos para mover las reglas dentro y fuera de mi telaraÃ±a:
            </p>
            <ul class="list-disc list-inside pl-4">
              <li>
                ğŸ“¤ Exportar reglas
                <br />
                Con este botÃ³n envuelvo todos las reglas tejidas en la telaraÃ±a
                y las empaco en un archivo JSON. AsÃ­ puedes guardarlas,
                compartirlas o llevÃ¡rtelas de paseo por otros navegadores. ğŸğŸ“¦
              </li>
              <li>
                ğŸ“¥ Importar reglas <br />
                Â¿Tienes hilos de reglas de otra telaraÃ±a? Dale clic a este botÃ³n
                y suÃ©ltalas aquÃ­. las ordeno y las dejo listas para que vuelvan
                a hacer su magia âœ¨
              </li>
            </ul>
            <p>
              Tanto el exportar como el importar deben ir en un archivo JSON con
              la siguiente estructura:
            </p>
            <pre>
[
  {
    "name": "Intercept de usuario",
    "url": "https://api.ejemplo.com/usuario/{id}",
    "method": "GET",
    "statusCode": 200,
    "webSite": "https://ejemplo.com",
    "response": {
      "id": 1,
      "nombre": "Lucy"
    }
  },
  ...
]
            </pre>
            <strong class="text-purple-700"
              >âš ï¸ Importante: cuando importes, tus reglas actuales no se
              perderÃ¡n. Pero por seguridad, todas se desactivarÃ¡n. Revisa que
              todo estÃ© bien y activa las que necesites.
            </strong>
          </div>
          <hr class="border-purple-800" />
          <div id="extension">
            <h4 class="text-lg font-bold flex items-center">
              ğŸ“ Indicador en el Ã­cono de la extensiÃ³n
            </h4>
            <p>
              Â¿Ves ese con un nÃºmero junto al Ã­cono de la extensiÃ³n? ğŸ•¸ï¸ Ese soy
              yo, Lucy, mostrÃ¡ndote cuÃ¡ntas trampas tengo activas.
            </p>
            <img
              src="indicator.png"
              alt="Indicador de trampas activas en el Ã­cono de Lucy"
            />
            <p>
              El nÃºmero indica cuÃ¡ntas reglas estÃ¡n vigilando URLs ahora mismo.
            </p>
            <ul class="list-disc list-inside pl-4">
              <li>ğŸ”¢ Si hay trampas activas, te muestro cuÃ¡ntas.</li>
              <li>ğŸŒ‘ Si no hay ninguna, muestro 0 y en oscuro.</li>
            </ul>
            <p>
              AsÃ­ puedes ver de un vistazo si estoy en modo caza... o de siesta
              ğŸ’¤.
            </p>
            <h5 class="font-bold flex items-center">
              âœ¨ Parpadeo del Ã­cono: Â¡caza exitosa!
            </h5>
            <p>
              Me encanta compartir la emociÃ³n cuando una caza sale bien. Por
              eso, el Ã­cono junto a la extensiÃ³n parpadearÃ¡ cada vez que atrape
              un bicho en forma de peticiÃ³n HTTP.
            </p>
            <p>
              Este destello fugaz es mi forma de aplaudir mi propia punterÃ­a. Si
              lo ves brillar, sabÃ©s que alguna trampa se activÃ³ y devorÃ© una
              peticiÃ³n antes de que llegara al servidor.
            </p>
            <p>
              ğŸ§  Consejo de Lucy: Si el Ã­cono no parpadea, probablemente no haya
              ningÃºn bicho activoâ€¦ o me estoy tomando un descanso ğŸ’¤.
            </p>
          </div>
          <hr class="border-purple-800" />
          <p>
            Gracias por confiar en Lucy. Estamos abiertos a cualquier sugerencia
            que quieras compartir.
          </p>
          <p>Hecho con â¤ï¸ por Diego LÃ³pez.</p>
          <p>â€” â€œY vigilado por mÃ­, claro ğŸ•·ï¸â€ â€”Lucy</p>
        </div>
      </div>
    </div>
    <script src="tailwind_4.js"></script>
    <script src="popup.js" type="module"></script>
  </body>
</html>
